<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{ torrent.name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* Set Montserrat font */
        @import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');
        body {
            font-family: 'Montserrat', sans-serif;
        }
        img {
            width: 400px;
            height: auto;
        }
        .torrent-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
        }
        h1 {
            font-size: 36px;
            margin-bottom: 10px;
            /* Set blue color for the name */
            color: #0f4c81;
        }
        h2 {
            font-size: 24px;
            margin-top: 20px;
            margin-bottom: 10px;
            /* Set blue color for the category */
            color: #0f4c81;
        }
        p {
            line-height: 1.5;
            margin-bottom: 20px;
        }
        ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        li {
            margin-bottom: 5px;
        }
        .edit-button {
          display: block;
          width: 100px;
          margin: 20px auto 0;
          padding: 10px 15px;
          text-align:center;
          background-color:#0f4c81;
          color:white;
          text-decoration:none;
          border-radius:5px
        }
        
        /* Add styles for comments */
        .comments-container {
          margin-top:40px
        }
        
        .comment-form textarea {
          width:100%;
          height:80px
        }
        
        .comment-form button {
          display:block;
          margin-top:10px
        }
        
        .comment {
          border-top:1px solid #ccc;
          padding-top:10px
        }
        
        .comment:first-of-type {
          border-top:none
        }
        
        .comment-author {
          font-weight:bold
        }
        
        .comment-actions a{
          margin-right:10px
        }
    </style>
</head>
<body>
    <div class="torrent-container">
      <h1>{{ torrent.name }}</h1>

      <img src="{{ torrent.image_link }}" alt="{{ torrent.name }}">
      <h2> {{ torrent.category }}</h2>
      <p>{{ torrent.description }}</p>

      <ul>
          {% for attribute in torrent.attributes %}
              {% if attribute.name == 'Uploaded By' %}
                  <li>{{ attribute.name }}:<a href="/account/{{ attribute.value }}">{{ attribute.value }}</a></li>
              {% else %}
                  <li>{{ attribute.name }}: {{ attribute.value }}</li>
              {% endif %}
          {% endfor %}
      </ul>

      {% if session['username'] == torrent.uploaded_by %}
      <a class="edit-button" href="/torrents/{{ torrent.id }}/edit">Edit</a>
      {% endif %}
      
      <!-- Add comments section -->
      <div class="comments-container">
         <h2>Comments</h2>
         
         <!-- Add comment form -->
         <form class="comment-form" action="/torrents/{{ torrent.id }}/comments" method="POST">
           <textarea name="comment" placeholder="Add a comment..."></textarea>
           <button type="submit">Submit</button>
         </form>
         
         <!-- Display comments -->
         {% for comment in torrent.comments %}
           <div class="comment">
             <p><span class="comment-author">{{ comment.username }}</span> said:</p>
             <p>{{ comment.comment }}</p>
             <p class="comment-actions">
               <!-- Add edit and delete links if user is the author of the comment -->
               {% if session['user_id'] == comment.user_id %}
                 <a href="/comments/{{ comment.id }}/edit">Edit</a>
                 <a href="/comments/{{ comment.id }}/delete">Delete</a>
               {% endif %}
               
               <!-- Add upvote and downvote links -->
               <form action="/comments/{{ comment.id }}/upvote" method="POST">
                 <button type="submit">Upvote ({{ comment.upvotes }})</button>
               </form>
               <form action="/comments/{{ comment.id }}/downvote" method="POST">
                 <button type="submit">Downvote ({{ comment.downvotes }})</button>
               </form>
             </p>
           </div>
         {% endfor %}
      </div>

    </div>
</body>
</html>


