<!DOCTYPE html>
<html>
<head>
    <title>Upload</title>
    <script src="https://cdn.jsdelivr.net/webtorrent/latest/webtorrent.min.js"></script>
    <script>
        function extractMagnet() {
            var torrentFile = document.getElementById('torrent_file').files[0];
            var client = new WebTorrent();
            client.on('error', function (err) {
                console.error(err);
            });
            client.add(torrentFile, function (torrent) {
                var magnetLink = torrent.magnetURI;
                document.getElementById('magnet_link').value = magnetLink;
            });
        }
    </script>
</head>
<body>
    {% if error %}
        <p style="color: red">{{ error }}</p>
    {% endif %}
    <form method="post" action="/upload" enctype="multipart/form-data">
        <label for="model_name">Model name:</label>
        <input type="text" name="model_name" id="model_name"><br>
        <label for="short_description">Short description:</label>
        <textarea name="short_description" id="short_description"></textarea><br>
        <label for="torrent_file">Torrent file:</label>
        <input type="file" name="torrent_file" id="torrent_file" onchange="extractMagnet()"><br>
        <label for="image_link">Image link:</label>
        <input type="text" name="image_link" id="image_link"><br>
        <label for="magnet_link" style="display:block;">Magnet link:</label>
        <textarea name="magnet_link" id="magnet_link" readonly rows="5"></textarea><br>
        <input type="submit" value="Upload">
    </form>
</body>
</html>
